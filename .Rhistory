plot(non_nn_scores_cond_full,log10(comb_fdr[,1]),xlim=c(0,5),ylim=c(-5,0))
source('~/.active-rstudio-document', echo=TRUE)
plot(non_nn_scores_cond_full,log10(comb_fdr[,1]),xlim=c(0,5),ylim=c(-5,0))
plot(non_nn_scores_cond_full,log10(comb_fdr[,1]),xlim=c(0,20),ylim=c(-5,0))
plot(non_nn_scores_cond_full,log10(comb_fdr[,1]),xlim=c(0,20),ylim=c(-30,0))
apply(comb_fdr,2,min)
apply(comb_fdr,1,min)
sum(apply(comb_fdr,1,min) > 0.05)
sum(apply(comb_fdr,1,min) < 0.05)
max(non_nn_scores_cond_full[apply(comb_fdr,1,min) < 0.05,])
dim(comb_fdr)
length(non_nn_scores_cond_full)
max(non_nn_scores_cond_full[apply(comb_fdr,1,min) < 0.05])
min(non_nn_scores_cond_full[apply(comb_fdr,1,min) < 0.05])
min(abs(non_nn_scores_cond_full[apply(comb_fdr,1,min) < 0.05]))
source('~/.active-rstudio-document', echo=TRUE)
sum(apply(comb_fdr,1,min) < 0.05)
sum(apply(comb_fdr,1,min) > 0.05)
test <- `<=`
test(1,2)
source('~/.active-rstudio-document', echo=TRUE)
plot(non_nn_scores_cond_full,log10(comb_fdr[,1]),xlim=c(0,20),ylim=c(-30,0))
plot(non_nn_scores_cond_full,log10(comb_fdr[,1]))
plot(non_nn_scores_cond_full,log10(comb_fdr[,2]))
hist(gi_data[nn_pairs,'Z_GIS_ij.DMSO'])
qqnorm(gi_data[nn_pairs,'Z_GIS_ij.DMSO'])
abline(c(0,1))
source('~/.active-rstudio-document', echo=TRUE)
plot(non_nn_scores_cond_full,log10(comb_fdr[,2]))
log10(0.05)
abline(h=-1.3)
plot(non_nn_scores_cond_full,log10(comb_fdr[,1]))
abline(h=-1.3)
sum(apply(comb_fdr,1,min) < 0.05)
sum(apply(comb_fdr,1,min) > 0.05)
dim(comb_fdr)
source('~/.active-rstudio-document', echo=TRUE)
sum(apply(comb_fdr,1,min) > 0.05)
sum(apply(comb_fdr,1,min) < 0.05)
source('~/.active-rstudio-document', echo=TRUE)
sum(apply(comb_fdr,1,min) < 0.05)
sum(apply(comb_fdr,1,min) > 0.05)
sum(apply(comb_fdr,1,min) > 0.01)
sum(apply(comb_fdr,1,min) < 0.01)
source('~/.active-rstudio-document', echo=TRUE)
sum(apply(comb_fdr,1,min) < 0.01)
sum(apply(comb_fdr,1,min) < 0.05)
source('~/.active-rstudio-document', echo=TRUE)
sum(apply(comb_fdr,1,min) < 0.05)
sum(apply(comb_fdr,1,min) > 0.05)
sum(apply(comb_fdr,1,min) < 0.01)
source('~/.active-rstudio-document', echo=TRUE)
sum(apply(comb_fdr,1,min) < 0.01)
sum(apply(comb_fdr,1,min) < 0.05)
sum(apply(comb_fdr,1,min) > 0.05)
hist(nn_scores_cond)
hist(non_nn_scores_cond)
hist(non_nn_scores_cond_full)
hist(non_nn_scores_cond_full,breaks=100)
lines(density(non_nn_scores_cond_full))
plot(density(non_nn_scores_cond_full))
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
hist(diff_nn)
hist(diff_nn,breaks=100)
sum(abs(diff_nn) > 5)
sum(abs(diff_nn) > 10)
sum(abs(diff_nn) > 5)
sum(abs(diff_nn) > 6)
source('~/.active-rstudio-document', echo=TRUE)
hist(diff_nn,breaks=100)
hist(diff_non_nn,breaks=100)
hist(diff_non_nn,breaks=1000)
?hist
hist(diff_non_nn,breaks=1000,freq=F)
hist(diff_nn,breaks=1000,freq=F,add=T,col='red')
hist(diff_nn,breaks=1000,freq=F,col='red')
?hist
hist(diff_nn,breaks=1000,freq=F,col='red',border=NA)
hist(diff_non_nn,breaks=1000,freq=F,add=T)
plot(density(diff_nn))
plot(density(diff_nn),col='red')
plot(density(diff_nn),col='red',lwd=2)
lines(density(diff_non_nn),col='black',lwd=2)
source('~/.active-rstudio-document', echo=TRUE)
plot(fdrs_neg)
dim(fdrs_neg)
plot(apply(comb_fdr,1,min))
dev.off()
plot(non_nn_scores_cond_full,apply(comb_fdr,1,min)))
plot(non_nn_scores_cond_full,apply(comb_fdr,1,min))
plot(non_nn_scores_cond_full,log10(apply(comb_fdr,1,min)),xlim=c(-7,7))
plot(non_nn_scores_cond_full,log10(apply(comb_fdr,1,min)),xlim=c(-7,7),ylim=c(-2,0))
log10(0.05)
abline(h=-1.3)
abline(v=5)
abline(v=-5)
sum(non_nn_scores_cond_full < -5)
sum(non_nn_scores_cond_full > 5)
sum(non_nn_scores_cond_full > 5.1)
sum(non_nn_scores_cond_full < -5.1)
source('~/.active-rstudio-document', echo=TRUE)
sum(abs(nn_scores_cond) > 5)
nn_scores_cond
hist(nn_scores_cond)
sum(abs(non_nn_scores_cond) > 5)
sum(non_nn_scores_cond < -5)
sum(non_nn_scores_cond > 5)
sum(abs(non_nn_scores_cond) > 5)
sum(abs(non_nn_scores_cond) > 5)
sum(abs(non_nn_scores_cond) < 5)
source('~/.active-rstudio-document', echo=TRUE)
sum(abs(non_nn_scores_cond) < 5)
sum(abs(non_nn_scores_cond) > 5)
sum(abs(non_nn_scores_cond_full) > 5)
source('~/.active-rstudio-document', echo=TRUE)
source('~/Dropbox/Roth Lab/projects/BFG_GI_stats/scripts/master.R', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
sum(abs(non_nn_scores_cond_full) > 5)
sum(abs(non_nn_scores_cond_full) > 10)
hist(nn_scores_cond_full)
hist(nn_scores_cond)
hist(non_nn_scores_cond_full)
source('~/.active-rstudio-document', echo=TRUE)
sum(abs(non_nn_scores_cond_full) > 10)
sum(abs(non_nn_scores_cond_full) > 5)
source('~/.active-rstudio-document', echo=TRUE)
sum(abs(non_nn_scores_cond_full) > 5)
sum(abs(non_nn_scores_cond_full) < 5)
25*25
sum(abs(non_nn_scores_cond_full) < 5)
sum(abs(non_nn_scores_cond_full) > 5)
colnames(gi-data)
head(gi_data[ddr_pairs,'Z_GIS_ij.MMS_Class'])
sum(gi_data[ddr_pairs,'Z_GIS_ij.MMS_Class'] != gi_data[ddr_pairs,'Z_GIS_ij.4NQO_Class'])
sum(gi_data_old[ddr_pairs,'Z_GIS_ij.MMS_Class'] != gi_data_old[ddr_pairs,'Z_GIS_ij.4NQO_Class'])
sum(gi_data_old[ddr_pairs,'Z_GIS_ij.MMS_Class'] != gi_data_old[ddr_pairs,'Z_GIS_ij.CMPT_Class'])
sum(gi_data[ddr_pairs,'Z_GIS_ij.MMS_Class'] != gi_data[ddr_pairs,'Z_GIS_ij.CMPT_Class'])
non_nn_scores_cond_full <- gi_data[ddr_pairs,'Z_GIS_ij.MMS'] - gi_data[ddr_pairs,'Z_GIS_ij.CMPT']
sum(abs(non_nn_scores_cond_full) > 5)
nn_scores_cond <- gi_data[nn_pairs,'Z_GIS_ij.MMS'] - gi_data[nn_pairs,'Z_GIS_ij.CMPT']
sum(abs(nn_scores_cond) > 5)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
apply(comb_fdr,1,min)
plot(non_nn_scores_cond_full,log10(apply(comb_fdr,1,min)))
plot(non_nn_scores_cond_full,log10(apply(comb_fdr,1,min)),ylim=c(-2,0))
plot(non_nn_scores_cond_full,log10(apply(comb_fdr,1,min)),ylim=c(-2,0),xlim=c(-10,10))
abline(v=5)
abline(v=6)
abline(v=7)
abline(v=-7)
sum(abs(nn_scores_cond) > 7)
sum(abs(non_nn_scores_cond) > 7)
source('~/.active-rstudio-document', echo=TRUE)
sum(abs(non_nn_scores_cond) > 7)
sum(abs(non_nn_scores_cond) > 5)
sum(abs(non_nn_scores_cond) > 1)
sum(abs(non_nn_scores_cond) > 2)
sum(abs(non_nn_scores_cond) > 3)
sum(abs(non_nn_scores_cond) > 4)
sum(abs(non_nn_scores_cond) > 5)
sum(abs(non_nn_scores_cond_full) > 7)
source('~/.active-rstudio-document', echo=TRUE)
sum(abs(non_nn_scores_cond_full) > 7)
sum(gi_data_old[ddr_pairs,'Z_GIS_ij.MMS_Class'] != gi_data_old[ddr_pairs,'Z_GIS_ij.CMPT_Class'])
sum(gi_data[ddr_pairs,'Z_GIS_ij.MMS_Class'] != gi_data[ddr_pairs,'Z_GIS_ij.CMPT_Class'])
sum(abs(non_nn_scores_cond_full) > 10)
sum(abs(non_nn_scores_cond_full) > 7)
length(non_nn_scores_cond_full)
source('~/.active-rstudio-document', echo=TRUE)
sum(abs(non_nn_scores_cond_full) > 7)
sum(abs(non_nn_scores_cond_full) > 5)
sum(gi_data[ddr_pairs,'Z_GIS_ij.MMS_Class'] != gi_data[ddr_pairs,'Z_GIS_ij.CMPT_Class'])
sum(gi_data_old[ddr_pairs,'Z_GIS_ij.MMS_Class'] != gi_data_old[ddr_pairs,'Z_GIS_ij.CMPT_Class'])
plot(non_nn_scores_cond_full,log10(apply(comb_fdr,1,min)),ylim=c(-2,0),xlim=c(-10,10))
sum(abs(non_nn_scores_cond_full) > 7)
source('~/.active-rstudio-document', echo=TRUE)
plot(non_nn_scores_cond_full,log10(apply(comb_fdr,1,min)),ylim=c(-2,0),xlim=c(-10,10))
sum(abs(non_nn_scores_cond_full) > 5)
sum(gi_data_old[ddr_pairs,'Z_GIS_ij.MMS_Class'] != gi_data_old[ddr_pairs,'Z_GIS_ij.CMPT_Class'])
sum(gi_data[ddr_pairs,'Z_GIS_ij.MMS_Class'] != gi_data[ddr_pairs,'Z_GIS_ij.CMPT_Class'])
sum(gi_data[ddr_pairs,'Z_GIS_ij.ZEOC_Class'] != gi_data[ddr_pairs,'Z_GIS_ij.BLMC_Class'])
sum(gi_data_old[ddr_pairs,'Z_GIS_ij.ZEOC_Class'] != gi_data_old[ddr_pairs,'Z_GIS_ij.BLMC_Class'])
source('~/.active-rstudio-document', echo=TRUE)
fdr_scores
nn_z_scores_cond <- gi_data[nn_pairs,'Z_GIS_ij.ZEOC'] - gi_data[nn_pairs,'Z_GIS_ij.BLMC']
non_nn_z_scores_cond <- gi_data[ddr_pairs,'Z_GIS_ij.ZEOC'] - gi_data[ddr_pairs,'Z_GIS_ij.BLMC']
#stop()
unequal_tests <- c(`>=`,`<=`)
precision_list <- lapply(unequal_tests,function(unequal_test){
mu <- mean(nn_z_scores_cond)
sigma <- sd(nn_z_scores_cond)
sapply(1:length(non_nn_z_scores_cond),function(i){
observed <- sum(unequal_test(non_nn_z_scores_cond, non_nn_z_scores_cond[i]))
if(all.equal(unequal_test,`<=`) == T){
use_lower_tail <- T
}else{
use_lower_tail <- F
}
#Using normal distribuion to calculate expected
expected <- pnorm(non_nn_z_scores_cond[i],mean=mu,sd=sigma,lower.tail=use_lower_tail)
#expected <- sum(unequal_test(nn_z_scores_cond, non_nn_z_scores_cond[i]))/length(non_nn_z_scores_cond)
expected <- expected*length(non_nn_z_scores_cond)
fdr <- (expected/observed)
#No sense returning fdr estimates >100%
return(min(fdr,1))
})
})
fdrs_pos <- precision_list[[1]]
fdrs_neg <- precision_list[[2]]
comb_fdr <- cbind(fdrs_pos,fdrs_neg)
#Return positive or negative FDRs based on the nominal sign
#of the interaction
fdr_scores <- sapply(1:nrow(comb_fdr),function(i){
if(non_nn_z_scores_cond[i,condition] < 0){
return(fdrs_neg[i])
}else{
return(fdrs_pos[i])
}
})
#
# fdr_matrix <- cbind(fdr_matrix,fdr_scores)
source('~/.active-rstudio-document', echo=TRUE)
fdr_scores
nn_z_scores_cond <- gi_data[nn_pairs,'Z_GIS_ij.ZEOC'] - gi_data[nn_pairs,'Z_GIS_ij.BLMC']
non_nn_z_scores_cond <- gi_data[ddr_pairs,'Z_GIS_ij.ZEOC'] - gi_data[ddr_pairs,'Z_GIS_ij.BLMC']
#stop()
unequal_tests <- c(`>=`,`<=`)
precision_list <- lapply(unequal_tests,function(unequal_test){
mu <- mean(nn_z_scores_cond)
sigma <- sd(nn_z_scores_cond)
sapply(1:length(non_nn_z_scores_cond),function(i){
observed <- sum(unequal_test(non_nn_z_scores_cond, non_nn_z_scores_cond[i]))
if(all.equal(unequal_test,`<=`) == T){
use_lower_tail <- T
}else{
use_lower_tail <- F
}
#Using normal distribuion to calculate expected
expected <- pnorm(non_nn_z_scores_cond[i],mean=mu,sd=sigma,lower.tail=use_lower_tail)
#expected <- sum(unequal_test(nn_z_scores_cond, non_nn_z_scores_cond[i]))/length(non_nn_z_scores_cond)
expected <- expected*length(non_nn_z_scores_cond)
fdr <- (expected/observed)
#No sense returning fdr estimates >100%
return(min(fdr,1))
})
})
fdrs_pos <- precision_list[[1]]
fdrs_neg <- precision_list[[2]]
comb_fdr <- cbind(fdrs_pos,fdrs_neg)
#Return positive or negative FDRs based on the nominal sign
#of the interaction
fdr_scores <- sapply(1:nrow(comb_fdr),function(i){
if(non_nn_z_scores_cond[i] < 0){
return(fdrs_neg[i])
}else{
return(fdrs_pos[i])
}
})
#
fdr_scores
plot(non_nn_scores_cond,fdr_scores)
plot(non_nn_scores_cond,comb_fdr[,1])
precision_list
source('~/.active-rstudio-document', echo=TRUE)
plot(non_nn_scores_cond,comb_fdr[,1])
plot(nn_scores_cond,comb_fdr[,1])
plot(nn_scores_cond)
plot(non_nn_scores_cond,comb_fdr[,1])
source('~/.active-rstudio-document', echo=TRUE)
plot(non_nn_scores_cond,comb_fdr[,1])
source('~/.active-rstudio-document', echo=TRUE)
source('~/Dropbox/Roth Lab/projects/BFG_GI_stats/scripts/master.R', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
plot(non_nn_scores_cond,comb_fdr[,1])
plot(non_nn_scores_cond,comb_fdr[,2])
hist(nn_scores_cond)
hist(non_nn_scores_cond)
source('~/.active-rstudio-document', echo=TRUE)
plot(non_nn_scores_cond,comb_fdr[,2])
plot(non_nn_scores_cond,comb_fdr[,1])
plot(non_nn_scores_cond,precision_list
[[1]])
plot(non_nn_scores_cond,precision_list[[1]])
plot(non_nn_scores_cond,precision_list[[2]])
nn_scores_cond
non_nn_scores_cond
non_nn_scores_cond_full
source('~/.active-rstudio-document', echo=TRUE)
plot(non_nn_scores_cond,precision_list[[2]])
plot(non_nn_scores_cond,precision_list[[1]])
source('~/.active-rstudio-document', echo=TRUE)
plot(non_nn_scores_cond,precision_list[[1]])
plot(non_nn_scores_cond,precision_list[[2]])
cor(non_nn_scores_cond,precision_list[[2]])
cor.test(non_nn_scores_cond,precision_list[[2]])
sum(ddr_pairs)
dim(non_nn_scores_cond_full)
length(non_nn_scores_cond_full)
plot(precision_list[[1]])
plot(precision_list[[1]],precision_list[[2]])
lengh(precision_list[[1]])
length(precision_list[[1]])
source('~/.active-rstudio-document', echo=TRUE)
plot(precision_list[[1]],precision_list[[2]])
plot(non_nn_scores_cond_full,precision_list[[2]])
plot(non_nn_scores_cond_full,precision_list[[1]])
source('~/.active-rstudio-document', echo=TRUE)
plot(non_nn_scores_cond_full,precision_list[[1]])
source('~/.active-rstudio-document', echo=TRUE)
plot(non_nn_scores_cond_full,precision_list[[1]])
source('~/.active-rstudio-document', echo=TRUE)
plot(non_nn_scores_cond_full,precision_list[[1]])
plot(non_nn_scores_cond,precision_list[[1]])
plot(non_nn_scores_cond,log10(precision_list[[1]]))
condition1
condition2
sum(precision_list[[1]] < 0.05)
sum(precision_list[[1]] < 0.01)
sum(precision_list[[2]] < 0.01)
sum(precision_list[[2]] < 0.001)
sum(precision_list[[1]] < 0.001)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
plot(non_nn_scores_cond,fdr_scores)
plot(non_nn_scores_cond,log10(fdr_scores))
abline(h=log10(0.05))
sum(fdr_scores < 0.05)
sum(fdr_scores < 0.01)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
z_class_name1 <- paste(c(z_name1,'Class'),colapse='_')
z_class_name2 <- paste(c(z_name2,'Class'),colapse='_')
gi_data[,z_class_name1]
z_class_name1
z_class_name1 <- paste(c(z_name1,'Class'),collapse='_')
z_class_name2 <- paste(c(z_name2,'Class'),collapse='_')
z_class_name1
gi_data[,z_class_name1]
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
hist(non_nn_scores_cond)
condition1
condition2
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
sum(ddr_pairs)
length(non_nn_scores_cond)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
hist(nn_scores_cond)
hist(non_nn_scores_cond)
sum(non_nn_scores_cond > 5)
sum(non_nn_scores_cond < -5)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
hist(non_nn_scores_cond)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
hist(nn_scores_cond)
hist(non_nn_scores_cond)
hist(nn_scores_cond,add=T,col='black')
hist(nn_scores_cond,add=T,col='black',freq=F)
hist(nn_scores_cond,add=F,col='black',freq=F)
hist(nn_scores_cond,add=F,col='black',freq=F,xlim=c(-20,20))
hist(non_nn_scores_cond,add=T,freq=F)
hist(non_nn_scores_cond,add=T,freq=F,breaks=100)
hist(non_nn_scores_cond,add=T,freq=F,breaks=100,col='wite')
hist(non_nn_scores_cond,add=T,freq=F,breaks=100,col='white')
hist(non_nn_scores_cond,add=T,freq=F,breaks=100,col='grey')
hist(nn_scores_cond,add=T,col='black',freq=F,xlim=c(-20,20))
hist(non_nn_scores_cond,add=T,freq=F,breaks=100,col=rgb(1,1,1,0.3))
source('~/.active-rstudio-document', echo=TRUE)
hist(nn_scores_cond,add=T,col='black',freq=F,xlim=c(-20,20))
hist(nn_scores_cond)
hist(non_nn_scores_cond)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
head(gi_data)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
ret_list[[']]
)
''
''
ret_list[['DMSO']][[]]
ret_list[['DMSO']][['MMS']]
names(ret_list[['DMSO']][['MMS']])
ret_list[['DMSO']][['MMS']]
length(ret_list[['DMSO']][['MMS']])
source('~/.active-rstudio-document', echo=TRUE)
length(ret_list[['DMSO']][['MMS']])
length(ret_list[['DMSO']][['MMS']],ret_list[['DMSO']][['NoDrug']])
intersect(ret_list[['DMSO']][['MMS']],ret_list[['DMSO']][['NoDrug']])
intersect(ret_list[['DMSO']][['MMS']],ret_list[['NoDrug']][['MMS']])
length(intersect(ret_list[['DMSO']][['MMS']],ret_list[['NoDrug']][['MMS']]))
length(intersect(ret_list[['DMSO']][['MMS']])
)
length(intersect(ret_list[['DMSO']][['MMS']]))
length(ret_list[['DMSO']][['MMS']])
length(ret_list[['NoDrug']][['MMS']])
length(intersect(ret_list[['DMSO']][['MMS']],ret_list[['NoDrug']][['MMS']]))
length(intersect(ret_list[['DMSO']][['4NQO']],ret_list[['NoDrug']][['4NQO']]))
length(ret_list[['NoDrug']][['4NQO']])
length(ret_list[['DMSO']][['4NQO']])
208/231
length(intersect(ret_list[['MMS']][['4NQO']],ret_list[['MMS']][['CMPT']]))
length(ret_list[['MMS']][['4NQO']])
length(ret_list[['MMS']][['CMPT']])
155/284
length(intersect(ret_list[['MMS']][['4NQO']],ret_list[['MMS']][['DMSO']]))
length(ret_list[['MMS']][['DMSO']])
length(ret_list[['MMS']][['4NQO']])
source('~/.active-rstudio-document', echo=TRUE)
colnames(gi_data_old)
sum(gi_data_old[,'Z_GIS_ij.NoDrug_Class'] != gi_data_old[,'Z_GIS_ij.MMS_Class'])
sum(gi_data_old[,'Z_GIS_ij.NoDrug_Class'] != gi_data_old[,'Z_GIS_ij.DMSO_Class'])
gi_data_old[,'Z_GIS_ij.NoDrug_Class'] != gi_data_old[,'Z_GIS_ij.DMSO_Class']
ddr_pairs_old <-
gi_data_old$Type_of_gene_i == 'DNA_repair' &
gi_data_old$Type_of_gene_j == 'DNA_repair'
sum(gi_data_old[ddr_pairs_old,'Z_GIS_ij.NoDrug_Class'] != gi_data_old[ddr_pairs_old,'Z_GIS_ij.DMSO_Class'])
sum(gi_data_old[ddr_pairs_old,'Z_GIS_ij.NoDrug_Class'] != gi_data_old[ddr_pairs_old,'Z_GIS_ij.MMS_Class'])
sum(gi_data_old[ddr_pairs_old,'Z_GIS_ij.DMSO_Class'] != gi_data_old[ddr_pairs_old,'Z_GIS_ij.MMS_Class'])
sum(gi_data_old[ddr_pairs_old,'Z_GIS_ij.CMPT_Class'] != gi_data_old[ddr_pairs_old,'Z_GIS_ij.MMS_Class'])
sum(gi_data_old[ddr_pairs_old,'Z_GIS_ij.CMPT_Class'] != gi_data_old[ddr_pairs_old,'Z_GIS_ij.DXRB_Class'])
a <- data.frame(rbind(c(1,2),c(2,3)))
a
a[,c(1,"X2")]
a[,c(1)]
a[,'X1']
a[,c(1,'X1')]
colnames(gi-data)
colnames(gi_data)
source('~/.active-rstudio-document', echo=TRUE)
retvec
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
head(retvec)
source('~/.active-rstudio-document', echo=TRUE)
head(ret_df)
sig
source('~/.active-rstudio-document', echo=TRUE)
head(ret_df)
head(ret_df,n=100)
head(ret_df,n=1000)
dim(ret_df)
head(ret_df,n=1000)
source('~/.active-rstudio-document', echo=TRUE)
head(ret_df,n=1000)
head(ret_df,n=10)
head(ret_df)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
head(ret_df)
plot(ret_df$DeltaZ,ret_df$DeltaZ_FDR)
abline(v=10)
abline(v=-10)
sum(ret_df$DeltaZ > 10)
sum(ret_df$DeltaZ < -10)
dim(ret_df)
dim(ret_df)
getwd()
setwd('../results/')
ls
list.files()
dir.create('scratch')
setwd('scratch')
write.table(ret_df)
write.table(ret_df,quote=F,row.names=F,sep='\t',file='new_differential_inters.tsv')
head(ret_df)
head(ret_df,n=10)
head(ret_df,n=20)
head(ret_df,n=30)
head(ret_df,n=50)
head(ret_df,n=40)
head(ret_df,n=35)
head(ret_df,n=33)
sum(ret_df$DeltaZ > 10)
sum(ret_df$DeltaZ > 0)
sum(ret_df$DeltaZ > 10)
sum(ret_df$DeltaZ > 7)
