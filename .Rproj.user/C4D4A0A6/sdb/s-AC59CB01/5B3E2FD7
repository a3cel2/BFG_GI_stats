{
    "collab_server" : "",
    "contents" : "################################################################\n################################################################\n################################################################\n########                                                ########\n########                                                ########\n########     Pipeline for update of BFG-GI data         ########\n########                                                ########\n########                                                ########\n########                                                ########\n################################################################\n################################################################\n################################################################\nrequire(Cairo)\n\nthis.dir <- dirname(parent.frame(2)$ofile)\nsetwd(this.dir)\n\ndevtools::load_all('../packages/BfgGiStats')\ndevtools::document('../packages/BfgGiStats')\n\nsetwd('../data')\n\n#Read in genetic interaction data from two tables, using sum column from second table\ngi_data <-\n  read.table('table_s1_input.tsv', head = T, stringsAsFactors = F)\n#Remove count data from first table\ngi_data <- gi_data[,-grep('^C_',colnames(gi_data))]\n\n#Can change this to look at only one of the two technical replicates, analyzes the sum by default\n#Change grep pattern to '^C_ij.*R1' or '^C_ij.*R2' to look at one of the two only\n\ngi_data_2 <-\n  read.table('Cij_Table_WithReplicates.txt', head = T, stringsAsFactors = F)\ngi_data <- cbind(gi_data,gi_data_2[,grep('^C_ij.*sum',colnames(gi_data_2))])\n#Fix the names\ncolnames(gi_data) <- gsub('.sum','',colnames(gi_data))\n\n#Remove non well-measured strains\nwell_measured <- gi_data[,grep('HetDipl',colnames(gi_data))] >= 100\ngi_data <- gi_data[well_measured, ]\n\n\ngi_data_old <- gi_data\n\n\n#Change genetic interactions and significance calls\ngi_data <- update_gis(gi_data,\n                      #These values are empirically determined and have to be\n                      #in the same order as in gi_data count columns\n                      g_wt_vec = c(12.62,\n                                   8.34,\n                                   8.44,\n                                   7.04,\n                                   7.7,\n                                   7.84,\n                                   7.5,\n                                   7.76,\n                                   6.94,\n                                   6.28))\n\n\n#Add FDR columns\ngi_data <- add_fdrs(gi_data)\n\n\n#Update calls based on FDR columns\ngi_data <- update_calls(gi_data,use_z = F,fdr_cutoff = 0.05)\n\n\n##Making several plots\nsetwd(this.dir)\nsetwd('../results')\nCairo::CairoPDF(file='gi_fdr_prec_vs_st_onge.pdf',width=4.5,height=4)\nprecision_vs_stonge(gi_data)\ndev.off()\n\nCairo::CairoPDF(file='auc_vs_st_onge_new.pdf',width=7.5,height=4)\npar(mfrow=c(1,2))\nst_onge_auc_plot(gi_data)\ndev.off()\n\n#Cairo::CairoPDF(file='auc_vs_st_onge_old.pdf',width=7.5,height=4)\n#par(mfrow=c(1,2))\n#st_onge_auc_plot(gi_data_old,old_data=T)\n#dev.off()\n\nCairo::CairoPDF(file='st_onge_scatterplot.pdf',width=7.5,height=3.5)\npar(mfrow=c(1,2))\nst_onge_scatterplot(gi_data)\ndev.off()\n\n#Update the table\nsetwd(this.dir)\nsetwd('../data')\nwrite.table(gi_data,row.names=F,quote=F,sep='\\t',file='table_s1.tsv')\n\n#Make differential calls\ndifferential_calls <- differential_gi_analysis(gi_data,\n                                               #Report everything\n                                               fdr_cutoff = 2,\n                                               require_sign_change = F)\nwrite.table(differential_calls,row.names=F,quote=F,sep='\\t',file='table_s2.tsv')",
    "created" : 1508179925260.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3147835349",
    "id" : "5B3E2FD7",
    "lastKnownWriteTime" : 1514936918,
    "last_content_update" : 1514936918162,
    "path" : "~/Dropbox/Roth Lab/projects/BFG_GI_stats/scripts/master.R",
    "project_path" : "scripts/master.R",
    "properties" : {
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}